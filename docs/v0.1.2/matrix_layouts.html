
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Matrix layouts · DataAxesFormats.jl v0.1.2
</title>
<meta name="title" content="Matrix layouts · DataAxesFormats.jl v0.1.2"/>
<meta property="og:title" content="Matrix layouts · DataAxesFormats.jl v0.1.2"/>
<meta property="twitter:title" content="Matrix layouts · DataAxesFormats.jl v0.1.2"/>
<meta name="description" content="Documentation for DataAxesFormats.jl v0.1.2."/>
<meta property="og:description" content="Documentation for DataAxesFormats.jl v0.1.2."/>
<meta property="twitter:description" content="Documentation for DataAxesFormats.jl v0.1.2."/>
<script data-outdated-warner src="assets/warner.js">
</script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/>
<script>documenterBaseURL="."
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js">
</script>
<script src="search_index.js">
</script>
<script src="siteinfo.js">
</script>
<script src="../versions.js">
</script>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/>
<script src="assets/themeswap.js">
</script>
</head>
<body>
<div id="documenter">
<nav class="docs-sidebar">
<a class="docs-logo" href="index.html">
<img src="assets/logo.svg" alt="DataAxesFormats.jl v0.1.2 logo"/>
</a>
<div class="docs-package-name">
<span class="docs-autofit">
<a href="index.html">DataAxesFormats.jl v0.1.2
</a>
</span>
</div>
<button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)
</button>
<ul class="docs-menu">
<li>
<a class="tocitem" href="index.html">Daf
</a>
</li>
<li>
<a class="tocitem" href="readers.html">Readers
</a>
</li>
<li>
<a class="tocitem" href="writers.html">Writers
</a>
</li>
<li>
<a class="tocitem" href="read_only.html">Read-only
</a>
</li>
<li>
<a class="tocitem" href="queries.html">Queries
</a>
</li>
<li>
<a class="tocitem" href="tokens.html">Tokens
</a>
</li>
<li>
<a class="tocitem" href="views.html">Views
</a>
</li>
<li>
<a class="tocitem" href="chains.html">Chains
</a>
</li>
<li>
<a class="tocitem" href="computations.html">Computations
</a>
</li>
<li>
<a class="tocitem" href="copies.html">Copies
</a>
</li>
<li>
<a class="tocitem" href="concat.html">Concat
</a>
</li>
<li>
<a class="tocitem" href="adapters.html">Adapters
</a>
</li>
<li>
<a class="tocitem" href="contracts.html">Contracts
</a>
</li>
<li>
<a class="tocitem" href="formats.html">Formats
</a>
</li>
<li>
<a class="tocitem" href="keys.html">Keys
</a>
</li>
<li>
<a class="tocitem" href="memory_format.html">Memory Format
</a>
</li>
<li>
<a class="tocitem" href="h5df_format.html">H5DF Format
</a>
</li>
<li>
<a class="tocitem" href="files_format.html">Files Format
</a>
</li>
<li>
<a class="tocitem" href="anndata_format.html">AnnData Format
</a>
</li>
<li>
<a class="tocitem" href="reconstruction.html">Reconstruction
</a>
</li>
<li>
<a class="tocitem" href="registry.html">Operations registry
</a>
</li>
<li>
<a class="tocitem" href="operations.html">Query operations
</a>
</li>
<li>
<a class="tocitem" href="storage_types.html">Storage types
</a>
</li>
<li class="is-active">
<a class="tocitem" href="matrix_layouts.html">Matrix layouts
</a>
<ul class="internal">
<li>
<a class="tocitem" href="#Symbolic-names-for-axes">
<span>Symbolic names for axes
</span>
</a>
</li>
<li>
<a class="tocitem" href="#Checking-layout">
<span>Checking layout
</span>
</a>
</li>
<li>
<a class="tocitem" href="#Changing-layout">
<span>Changing layout
</span>
</a>
</li>
<li>
<a class="tocitem" href="#Changing-format">
<span>Changing format
</span>
</a>
</li>
<li>
<a class="tocitem" href="#Assertions">
<span>Assertions
</span>
</a>
</li>
<li>
<a class="tocitem" href="#Index">
<span>Index
</span>
</a>
</li>
</ul>
</li>
<li>
<a class="tocitem" href="groups.html">Groups
</a>
</li>
<li>
<a class="tocitem" href="messages.html">Messages
</a>
</li>
<li>
<a class="tocitem" href="generic_logging.html">Generic Logging
</a>
</li>
<li>
<a class="tocitem" href="generic_locks.html">Generic Locks
</a>
</li>
<li>
<a class="tocitem" href="generic_types.html">Generic Types
</a>
</li>
<li>
<a class="tocitem" href="generic_functions.html">Generic Functions
</a>
</li>
<li>
<a class="tocitem" href="example_data.html">Example data
</a>
</li>
</ul>
<div class="docs-version-selector field has-addons">
<div class="control">
<span class="docs-label button is-static is-size-7">Version
</span>
</div>
<div class="docs-selector control is-expanded">
<div class="select is-fullwidth is-size-7">
<select id="documenter-version-selector">
</select>
</div>
</div>
</div>
</nav>
<div class="docs-main">
<header class="docs-navbar">
<a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#">
</a>
<nav class="breadcrumb">
<ul class="is-hidden-mobile">
<li class="is-active">
<a href="matrix_layouts.html">Matrix layouts
</a>
</li>
</ul>
<ul class="is-hidden-tablet">
<li class="is-active">
<a href="matrix_layouts.html">Matrix layouts
</a>
</li>
</ul>
</nav>
<div class="docs-right">
<a class="docs-navbar-link" href="https://github.com/tanaylab/DataAxesFormats.jl/blob/main{path}?plain=1#L{line}" title="View the repository on GitHub">
<span class="docs-icon fa-brands">
</span>
<span class="docs-label is-hidden-touch">GitHub
</span>
</a>
<a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings">
</a>
<a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings">
</a>
</div>
</header>
<article class="content" id="documenter-page">
<h1 id="Matrix-layouts">
<a class="docs-heading-anchor" href="#Matrix-layouts">Matrix layouts
</a>
<a id="Matrix-layouts-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Matrix-layouts" title="Permalink">
</a>
</h1>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts" href="#DataAxesFormats.MatrixLayouts">
<code>DataAxesFormats.MatrixLayouts
</code>
</a> — 
<span class="docstring-category">Module
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<p>All stored 
<code>Daf
</code> matrix data has a clear matrix layout, that is, a 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.major_axis">
<code>major_axis
</code>
</a>, regardless of whether it is dense or sparse.
</p>
<p>That is, for 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.Columns">
<code>Columns
</code>
</a>-major data, the values of each column are laid out consecutively in memory (each column is a single contiguous vector), so any operation that works on whole columns will be fast (e.g., summing the value of each column). In contrast, the values of each row are stored far apart from each other, so any operation that works on whole rows will be very slow in comparison (e.g., summing the value of each row).
</p>
<p>For 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.Rows">
<code>Rows
</code>
</a>-major data, the values of each row are laid out consecutively in memory (each row is a single contiguous vector). In contrast, the values of each column are stored far apart from each other. In this case, summing columns would be slow, and summing rows would be fast.
</p>
<p>This is much simpler than the 
<a href="https://github.com/JuliaLinearAlgebra/ArrayLayouts.jl">ArrayLayouts
</a> module which attempts to fully describe the layout of N-dimensional arrays, a much more ambitious goal which is an overkill for our needs.
</p>
<div class="admonition is-info">
<header class="admonition-header">Note
</header>
<div class="admonition-body">
<p>The &quot;default&quot; layout in Julia is column-major, which inherits this from matlab, which inherits this from FORTRAN, allegedly because this is more efficient for some linear algebra operations. In contrast, Python 
<code>numpy
</code> uses row-major layout by default. In either case, this is just an arbitrary convention, and all systems work just fine with data of either memory layout; the key consideration is to keep track of the layout, and to apply operations &quot;with the grain&quot; rather than &quot;against the grain&quot; of the data.
</p>
</div>
</div>
</div>
</section>
</article>
<h2 id="Symbolic-names-for-axes">
<a class="docs-heading-anchor" href="#Symbolic-names-for-axes">Symbolic names for axes
</a>
<a id="Symbolic-names-for-axes-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Symbolic-names-for-axes" title="Permalink">
</a>
</h2>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.Rows" href="#DataAxesFormats.MatrixLayouts.Rows">
<code>DataAxesFormats.MatrixLayouts.Rows
</code>
</a> — 
<span class="docstring-category">Constant
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<p>A symbolic name for the rows axis. It is much more readable to write, say, 
<code>size(matrix, Rows)
</code>, instead of 
<code>size(matrix, 1)
</code>.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.Columns" href="#DataAxesFormats.MatrixLayouts.Columns">
<code>DataAxesFormats.MatrixLayouts.Columns
</code>
</a> — 
<span class="docstring-category">Constant
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<p>A symbolic name for the rows axis. It is much more readable to write, say, 
<code>size(matrix, Columns)
</code>, instead of 
<code>size(matrix, 2)
</code>.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.axis_name" href="#DataAxesFormats.MatrixLayouts.axis_name">
<code>DataAxesFormats.MatrixLayouts.axis_name
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">axis_name(axis::Maybe{Integer})::String
</code>
</pre>
<p>Return the name of the axis (for messages).
</p>
</div>
</section>
</article>
<h2 id="Checking-layout">
<a class="docs-heading-anchor" href="#Checking-layout">Checking layout
</a>
<a id="Checking-layout-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Checking-layout" title="Permalink">
</a>
</h2>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.major_axis" href="#DataAxesFormats.MatrixLayouts.major_axis">
<code>DataAxesFormats.MatrixLayouts.major_axis
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">major_axis(matrix::AbstractMatrix)::Maybe{Int8}
</code>
</pre>
<p>Return the index of the major axis of a matrix, that is, the axis one should keep 
<strong>fixed
</strong> for an efficient inner loop accessing the matrix elements. If the matrix doesn&#39;t support any efficient access axis, returns 
<code>nothing
</code>.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.require_major_axis" href="#DataAxesFormats.MatrixLayouts.require_major_axis">
<code>DataAxesFormats.MatrixLayouts.require_major_axis
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">require_major_axis(matrix::AbstractMatrix)::Int8
</code>
</pre>
<p>Similar to 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.major_axis">
<code>major_axis
</code>
</a> but will 
<code>error
</code> if the matrix isn&#39;t in either row-major or column-major layout.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.minor_axis" href="#DataAxesFormats.MatrixLayouts.minor_axis">
<code>DataAxesFormats.MatrixLayouts.minor_axis
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">minor_axis(matrix::AbstractMatrix)::Maybe{Int8}
</code>
</pre>
<p>Return the index of the minor axis of a matrix, that is, the axis one should 
<strong>vary
</strong> for an efficient inner loop accessing the matrix elements. If the matrix doesn&#39;t support any efficient access axis, returns 
<code>nothing
</code>.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.require_minor_axis" href="#DataAxesFormats.MatrixLayouts.require_minor_axis">
<code>DataAxesFormats.MatrixLayouts.require_minor_axis
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">require_minor_axis(matrix::AbstractMatrix)::Int8
</code>
</pre>
<p>Similar to 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.minor_axis">
<code>minor_axis
</code>
</a> but will 
<code>error
</code> if the matrix isn&#39;t in either row-major or column-major layout.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.other_axis" href="#DataAxesFormats.MatrixLayouts.other_axis">
<code>DataAxesFormats.MatrixLayouts.other_axis
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">other_axis(axis::Maybe{Integer})::Maybe{Int8}
</code>
</pre>
<p>Return the other 
<code>matrix
</code> 
<code>axis
</code> (that is, convert between 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.Rows">
<code>Rows
</code>
</a> and 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.Columns">
<code>Columns
</code>
</a>). If given 
<code>nothing
</code> returns 
<code>nothing
</code>.
</p>
</div>
</section>
</article>
<h2 id="Changing-layout">
<a class="docs-heading-anchor" href="#Changing-layout">Changing layout
</a>
<a id="Changing-layout-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Changing-layout" title="Permalink">
</a>
</h2>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.relayout!" href="#DataAxesFormats.MatrixLayouts.relayout!">
<code>DataAxesFormats.MatrixLayouts.relayout!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">relayout!(destination::AbstractMatrix, source::AbstractMatrix)::AbstractMatrix
relayout!(destination::AbstractMatrix, source::NamedMatrix)::NamedMatrix
</code>
</pre>
<p>Return the same 
<code>matrix
</code> data, but in the other memory layout.
</p>
<p>Suppose you have a column-major UMIs matrix, whose rows are cells, and columns are genes. Therefore, summing the UMIs of a gene will be fast, but summing the UMIs of a cell will be slow. A 
<code>transpose
</code> (no 
<code>!
</code>) of a matrix is fast; it creates a zero-copy wrapper of the matrix with flipped axes, so its rows will be genes and columns will be cells, but in row-major layout. Therefore, 
<strong>still
</strong>, summing the UMIs of a gene is fast, and summing the UMIs of a cell is slow.
</p>
<p>In contrast, 
<code>transpose!
</code> (with a 
<code>!
</code>) (or 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.transposer">
<code>transposer
</code>
</a>) is slow; it creates a rearranged copy of the data, also returning a matrix whose rows are genes and columns are cells, but this time, in column-major layout. Therefore, in this case summing the UMIs of a gene will be slow, and summing the UMIs of a cell will be fast.
</p>
<div class="admonition is-info">
<header class="admonition-header">Note
</header>
<div class="admonition-body">
<p>It is almost always worthwhile to 
<code>relayout!
</code> a matrix and then perform operations &quot;with the grain&quot; of the data, instead of skipping it and performing operations &quot;against the grain&quot; of the data. This is because (in Julia at least) the implementation of 
<code>transpose!
</code> is optimized for the task, while the other operations typically don&#39;t provide any specific optimizations for working &quot;against the grain&quot; of the data. The benefits of a 
<code>relayout!
</code> become even more significant when performing a series of operations (e.g., summing the gene UMIs in each cell, converting gene UMIs to fractions out of these totals, then computing the log base 2 of this fraction).
</p>
</div>
</div>
<p>If you 
<code>transpose
</code> (no 
<code>!
</code>) the result of 
<code>transpose!
</code> (with a 
<code>!
</code>), you end up with a matrix that 
<strong>appears
</strong> to be the same as the original (rows are cells and columns are genes), but behaves 
<strong>differently
</strong> - summing the UMIs of a gene will be slow, and summing the UMIs of a cell is fast. This 
<code>transpose
</code> of 
<code>transpose!
</code> is a common idiom and is basically what 
<code>relayout!
</code> does for you. In addition, 
<code>relayout!
</code> will work for both sparse and dense matrices, and if 
<code>destination
</code> is not specified, a 
<code>similar
</code> matrix is allocated automatically for it.
</p>
<div class="admonition is-info">
<header class="admonition-header">Note
</header>
<div class="admonition-body">
<p>The caller is responsible for providing a sensible 
<code>destination
</code> matrix (sparse for a sparse 
<code>source
</code>, dense for a non-sparse 
<code>source
</code>). This can be a transposed matrix. If 
<code>source
</code> is a 
<code>NamedMatrix
</code>, then the result will be a 
<code>NamedMatrix
</code> with the same axes. If 
<code>destination
</code> is also a 
<code>NamedMatrix
</code>, then its axes must match 
<code>source
</code>.
</p>
</div>
</div>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.relayout" href="#DataAxesFormats.MatrixLayouts.relayout">
<code>DataAxesFormats.MatrixLayouts.relayout
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">relayout(matrix::AbstractMatrix)::AbstractMatrix
relayout(matrix::NamedMatrix)::NamedMatrix
</code>
</pre>
<p>Same as 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.relayout!">
<code>relayout!
</code>
</a> but allocates the destination matrix for you. Is equivalent to 
<code>transpose(transposer(matrix))
</code>.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.transposer" href="#DataAxesFormats.MatrixLayouts.transposer">
<code>DataAxesFormats.MatrixLayouts.transposer
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">transposer(matrix::AbstractMatrix)::AbstractMatrix
transposer(matrix::NamedMatrix)::NamedMatrix
</code>
</pre>
<p>This is a shorthand for 
<code>LinearAlgebra.transpose!(similar(transpose(m)), m)
</code>. That is, this will return a transpose of a matrix, but instead of simply using a zero-copy wrapper, it actually rearranges the data. See 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.relayout!">
<code>relayout!
</code>
</a>.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.copy_array" href="#DataAxesFormats.MatrixLayouts.copy_array">
<code>DataAxesFormats.MatrixLayouts.copy_array
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">copy_array(array::AbstractArray)::AbstractArray
</code>
</pre>
<p>Create a mutable copy of an array. This differs from 
<code>Base.copy
</code> in the following:
</p>
<ul>
<li>Copying a read-only array is a mutable array. In contrast, both 
<code>Base.copy
</code> and 
<code>Base.deepcopy
</code> of a read-only array will return a read-only array, which is technically correct, but is rather pointless for 
<code>Base.copy
</code>.
</li>
<li>Copying will preserve the layout of the data; for example, copying a 
<code>Transpose
</code> array is still a 
<code>Transpose
</code> array. In contrast, while 
<code>Base.deepcopy
</code> will preserve the layout, 
<code>Base.copy
</code> will silently 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.relayout!">
<code>relayout!
</code>
</a> the matrix, which is both expensive and confusing.
</li>
<li>Copying a sparse vector or matrix gives the same type of sparse array or matrix. Copying anything else gives a simple dense array regardless of the original type. This is done because a 
<code>deepcopy
</code> of 
<code>PyArray
</code> will still share the underlying buffer. Sigh.
</li>
<li>Copying a vector of anything derived from 
<code>AbstractString
</code> returns a vector of 
<code>AbstractString
</code>.
</li>
</ul>
</div>
</section>
</article>
<h2 id="Changing-format">
<a class="docs-heading-anchor" href="#Changing-format">Changing format
</a>
<a id="Changing-format-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Changing-format" title="Permalink">
</a>
</h2>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.bestify" href="#DataAxesFormats.MatrixLayouts.bestify">
<code>DataAxesFormats.MatrixLayouts.bestify
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">bestify(
    matrix::AbstractMatrix{T};
    copy::Bool = false,
    sparse_if_saves_storage_fraction::AbstractFloat = 0.25,
)::AbstractMatrix{T} where {T &lt;: StorageReal}
bestify(
    matrix::AbstractVector{T};
    copy::Bool = false,
    sparse_if_saves_storage_fraction::AbstractFloat = 0.25,
)::AbstractVector{T} where {T &lt;: StorageReal}
</code>
</pre>
<p>Return a &quot;best&quot; (dense or sparse) version of an array. The sparse format is chosen if it saves at least 
<code>sparse_if_saves_storage_fraction
</code> of the storage of the dense format. If 
<code>copy
</code>, this will create a copy even if it is already in the best format.
</p>
<div class="admonition is-info">
<header class="admonition-header">Note
</header>
<div class="admonition-body">
<p>If not 
<code>copy
</code> and the matrix is already sparse, we do not change the integer index type, even though this may save space.
</p>
</div>
</div>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.densify" href="#DataAxesFormats.MatrixLayouts.densify">
<code>DataAxesFormats.MatrixLayouts.densify
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">densify(matrix::AbstractMatrix{T}; copy::Bool = false)::AbstractMatrix{T} where {T &lt;: StorageReal}
densify(vector::AbstractVector{T}; copy::Bool = false)::AbstractVector{T} where {T &lt;: StorageReal}
</code>
</pre>
<p>Return a dense version of an array. This will preserve matrix layout. If 
<code>copy
</code>, this will create a copy even if it is already dense.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.sparsify" href="#DataAxesFormats.MatrixLayouts.sparsify">
<code>DataAxesFormats.MatrixLayouts.sparsify
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">sparsify(matrix::AbstractMatrix{T}; copy::Bool = false)::AbstractMatrix{T} where {T &lt;: StorageReal}
sparsify(vector::AbstractVector{T}; copy::Bool = false)::AbstractVector{T} where {T &lt;: StorageReal}
</code>
</pre>
<p>Return a sparse version of an array. This will preserve the matrix layout. If 
<code>copy
</code>, this will create a copy even if it is already sparse.
</p>
</div>
</section>
</article>
<h2 id="Assertions">
<a class="docs-heading-anchor" href="#Assertions">Assertions
</a>
<a id="Assertions-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Assertions" title="Permalink">
</a>
</h2>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.@assert_vector" href="#DataAxesFormats.MatrixLayouts.@assert_vector">
<code>DataAxesFormats.MatrixLayouts.@assert_vector
</code>
</a> — 
<span class="docstring-category">Macro
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">@assert_vector(vector::Any, [n_elements::Integer])
</code>
</pre>
<p>Assert that the 
<code>vector
</code> is an 
<code>AbstractVector
</code> and optionally that it has 
<code>n_elements
</code>, with a friendly error message if it fails.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.@assert_matrix" href="#DataAxesFormats.MatrixLayouts.@assert_matrix">
<code>DataAxesFormats.MatrixLayouts.@assert_matrix
</code>
</a> — 
<span class="docstring-category">Macro
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">@assert_matrix(matrix::Any, [n_rows::Integer, n_columns::Integer], [major_axis::Int8])
</code>
</pre>
<p>Assert that the 
<code>matrix
</code> is an 
<code>AbstractMatrix
</code> and optionally that it has 
<code>n_rows
</code> and 
<code>n_columns
</code>. If the 
<code>major_axis
</code> is given, also calls 
<code>check_efficient_action
</code> to verify that the matrix is in an efficient layout.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.check_efficient_action" href="#DataAxesFormats.MatrixLayouts.check_efficient_action">
<code>DataAxesFormats.MatrixLayouts.check_efficient_action
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">check_efficient_action(
    source_file::AbstractString,
    source_line::Integer,
    operand::AbstractString,
    matrix::AbstractMatrix,
    axis::Integer,
)::Nothing
</code>
</pre>
<p>This will check whether the code about to be executed for an 
<code>operand
</code> which is 
<code>matrix
</code> works &quot;with the grain&quot; of the data, which requires the 
<code>matrix
</code> to be in 
<code>axis
</code>-major layout. If it isn&#39;t, then apply the 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.inefficient_action_handler">
<code>inefficient_action_handler
</code>
</a>. Typically this isn&#39;t invoked directly; instead use 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.@assert_matrix">
<code>@assert_matrix
</code>
</a>.
</p>
<p>In general, you 
<strong>really
</strong> want operations to go &quot;with the grain&quot; of the data. Unfortunately, Julia (and Python, and R, and matlab) will silently run operations &quot;against the grain&quot;, which would be 
<strong>painfully
</strong> slow. A liberal application of this function in your code will help in detecting such slowdowns, without having to resort to profiling the code to isolate the problem.
</p>
<div class="admonition is-info">
<header class="admonition-header">Note
</header>
<div class="admonition-body">
<p>This will not prevent the code from performing &quot;against the grain&quot; operations such as 
<code>selectdim(matrix, Rows, 1)
</code> for a column-major matrix, but if you add this check before performing any (series of) operations on a matrix, then you will have a clear indication of whether such operations occur. You can then consider whether to invoke 
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.relayout!">
<code>relayout!
</code>
</a> on the data, or (for data fetched from 
<code>Daf
</code>), simply query for the other memory layout.
</p>
</div>
</div>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="DataAxesFormats.MatrixLayouts.inefficient_action_handler" href="#DataAxesFormats.MatrixLayouts.inefficient_action_handler">
<code>DataAxesFormats.MatrixLayouts.inefficient_action_handler
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">inefficient_action_handler(handler::AbnormalHandler)::AbnormalHandler
</code>
</pre>
<p>Specify the 
<a href="generic_functions.html#DataAxesFormats.GenericFunctions.AbnormalHandler">
<code>AbnormalHandler
</code>
</a> to use when accessing a matrix in an inefficient way (&quot;against the grain&quot;). Returns the previous handler. The default handler is 
<code>WarnHandler
</code>.
</p>
</div>
</section>
</article>
<h2 id="Index">
<a class="docs-heading-anchor" href="#Index">Index
</a>
<a id="Index-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Index" title="Permalink">
</a>
</h2>
<ul>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts">
<code>DataAxesFormats.MatrixLayouts
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.Columns">
<code>DataAxesFormats.MatrixLayouts.Columns
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.Rows">
<code>DataAxesFormats.MatrixLayouts.Rows
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.axis_name">
<code>DataAxesFormats.MatrixLayouts.axis_name
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.bestify">
<code>DataAxesFormats.MatrixLayouts.bestify
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.check_efficient_action">
<code>DataAxesFormats.MatrixLayouts.check_efficient_action
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.copy_array">
<code>DataAxesFormats.MatrixLayouts.copy_array
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.densify">
<code>DataAxesFormats.MatrixLayouts.densify
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.inefficient_action_handler">
<code>DataAxesFormats.MatrixLayouts.inefficient_action_handler
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.major_axis">
<code>DataAxesFormats.MatrixLayouts.major_axis
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.minor_axis">
<code>DataAxesFormats.MatrixLayouts.minor_axis
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.other_axis">
<code>DataAxesFormats.MatrixLayouts.other_axis
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.relayout">
<code>DataAxesFormats.MatrixLayouts.relayout
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.relayout!">
<code>DataAxesFormats.MatrixLayouts.relayout!
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.require_major_axis">
<code>DataAxesFormats.MatrixLayouts.require_major_axis
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.require_minor_axis">
<code>DataAxesFormats.MatrixLayouts.require_minor_axis
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.sparsify">
<code>DataAxesFormats.MatrixLayouts.sparsify
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.transposer">
<code>DataAxesFormats.MatrixLayouts.transposer
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.@assert_matrix">
<code>DataAxesFormats.MatrixLayouts.@assert_matrix
</code>
</a>
</li>
<li>
<a href="matrix_layouts.html#DataAxesFormats.MatrixLayouts.@assert_vector">
<code>DataAxesFormats.MatrixLayouts.@assert_vector
</code>
</a>
</li>
</ul>
</article>
<nav class="docs-footer">
<a class="docs-footer-prevpage" href="storage_types.html">« Storage types
</a>
<a class="docs-footer-nextpage" href="groups.html">Groups »
</a>
<div class="flexbox-break">
</div>
<p class="footer-message">Powered by 
<a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl
</a> and the 
<a href="https://julialang.org/">Julia Programming Language
</a>.
</p>
</nav>
</div>
<div class="modal" id="documenter-settings">
<div class="modal-background">
</div>
<div class="modal-card">
<header class="modal-card-head">
<p class="modal-card-title">Settings
</p>
<button class="delete">
</button>
</header>
<section class="modal-card-body">
<p>
<label class="label">Theme
</label>
<div class="select">
<select id="documenter-themepicker">
<option value="auto">Automatic (OS)
</option>
<option value="documenter-light">documenter-light
</option>
<option value="documenter-dark">documenter-dark
</option>
<option value="catppuccin-latte">catppuccin-latte
</option>
<option value="catppuccin-frappe">catppuccin-frappe
</option>
<option value="catppuccin-macchiato">catppuccin-macchiato
</option>
<option value="catppuccin-mocha">catppuccin-mocha
</option>
</select>
</div>
</p>
<hr/>
<p>This document was generated with 
<a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl
</a> version 1.7.0. Using Julia version 1.11.2.
</p>
</section>
<footer class="modal-card-foot">
</footer>
</div>
</div>
</div>
</body>
</html>
